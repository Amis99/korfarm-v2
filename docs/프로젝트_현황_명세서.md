# 국어농장 v2 프로젝트 현황 명세서

최종 업데이트: 2026-02-03

---

## 1. 프로젝트 개요

국어 학습 플랫폼. 초1~고3 대상, 게이미피케이션(씨앗/수확물) 기반 학습 시스템.

- **프론트엔드**: React 19 + Vite 7 (포트 5173)
- **백엔드**: Spring Boot 3.2 + Kotlin (포트 8080)
- **DB**: MySQL 8.4 (로컬, root/korfarm)
- **GitHub**: https://github.com/Amis99/korfarm-v2 (master 브랜치)

---

## 2. 로컬 개발 환경 시작 방법

### 2-1. MySQL 시작

MySQL이 Windows 서비스로 등록되어 있지 않음. 수동 실행 필요:

```bash
# MySQL 서버 시작 (터미널 하나를 계속 열어둬야 함)
"C:\Program Files\MySQL\MySQL Server 8.4\bin\mysqld.exe" --datadir="C:\Users\RENEWCOM PC\mysql-data" --port=3306 --console
```

- DB명: `korfarm`
- 계정: root / korfarm

### 2-2. 백엔드 시작

```bash
cd "C:\Users\RENEWCOM PC\Documents\국어농장v2홈페이지\backend"
./gradlew bootRun
```

- http://localhost:8080/v1/health 로 확인

### 2-3. 프론트엔드 시작

```bash
cd "C:\Users\RENEWCOM PC\Documents\국어농장v2홈페이지\frontend"
npm run dev
```

- http://localhost:5173 에서 확인
- Vite 프록시 설정: `/v1` -> `http://localhost:8080`

---

## 3. 테스트 계정

| 구분 | 아이디 | 비밀번호 | 레벨 | 학년 | 역할 |
|------|--------|----------|------|------|------|
| 관리자 | admin | test1234 | 러셀1 | 중1 | ADMIN |
| 유료 회원 | paid | test1234 | 프레게2 | 초5 | STUDENT |
| 무료 회원 | free | test1234 | 소쉬르3 | 초3 | STUDENT |

> DB를 새로 만든 경우 계정이 없으므로 백엔드 API로 재생성 필요

---

## 4. 레벨 체계

| 레벨 ID | 한글명 | 대상 학년 |
|---------|--------|-----------|
| saussure1 | 소쉬르1 | 초1 |
| saussure2 | 소쉬르2 | 초2 |
| saussure3 | 소쉬르3 | 초3 |
| frege1 | 프레게1 | 초4 |
| frege2 | 프레게2 | 초5 |
| frege3 | 프레게3 | 초6 |
| russell1 | 러셀1 | 중1 |
| russell2 | 러셀2 | 중2 |
| russell3 | 러셀3 | 중3 |
| wittgenstein1 | 비트겐슈타인1 | 고1 |
| wittgenstein2 | 비트겐슈타인2 | 고2 |
| wittgenstein3 | 비트겐슈타인3 | 고3 |

---

## 5. 주요 기능 구현 현황

### 구현 완료

| 기능 | 프론트엔드 | 백엔드 | 비고 |
|------|-----------|--------|------|
| 랜딩 페이지 | LandingPage.jsx | - | 소개 페이지 |
| 로그인/회원가입 | LoginPage, SignupPage, ResetPage | AuthController, AuthService | JWT 인증 |
| 시작 페이지 (홈) | StartPage.jsx | - | 메인 대시보드 |
| 학습 허브 | LearningHubPage.jsx | - | 학습 콘텐츠 목록 |
| 학습 엔진 | EngineShell + 9개 모듈 | - | 워크시트, 독해, 문법 등 |
| 일일 퀴즈 | DailyQuizPage.jsx | LearningController | 레벨별 일일 1회 |
| 커뮤니티 | CommunityPage, PostDetail, PostWrite | BoardController | 게시판 시스템 |
| 랭킹 | RankingPage.jsx | SeasonController | 시즌 순위 |
| 쇼핑몰 | ShopPage, ProductDetailPage | ShopController | 교재/교구 판매 |
| 결제 | PaymentResultPage, SubscriptionPage | PaymentController | 구독/결제 |
| 관리자 대시보드 | AdminPage + 13개 하위 페이지 | 각 Admin*Controller | 전체 관리 |
| 운영 스테이션 | OpsStation.jsx | - | API 테스트 도구 |
| 학부모 연결 | ParentLinksPage, StudentLinkConfirmPage | ParentLinkService | 학부모-학생 연결 |
| 진단 인쇄 | DiagnosticPrintPage.jsx | PrintController | 진단 결과 인쇄 |
| 씨앗 경제 시스템 | - | EconomyService | 씨앗 획득/교환/소비 |
| 기능 플래그 | AdminFlagsPage.jsx | FeatureFlagService | 기능 ON/OFF |

### 학습 엔진 모듈 (9종)

| 모듈 키 | 모듈 파일 | 용도 |
|---------|----------|------|
| worksheet_quiz | WorksheetQuizModule.jsx | 객관식/빈칸 퀴즈 (일일 퀴즈 포함) |
| reading_intensive | ReadingIntensiveModule.jsx | 집중 독해 |
| reading_training | ReadingTrainingModule.jsx | 독해 훈련 |
| recall_cards | RecallCardsModule.jsx | 회상 카드 |
| confirm_click | ConfirmClickModule.jsx | 확인 클릭 |
| choice_judgement | ChoiceJudgementModule.jsx | 선택지 판별 |
| phoneme_change | PhonemeChangeModule.jsx | 음운 변동 |
| word_formation | WordFormationModule.jsx | 단어의 형성 |
| sentence_structure | SentenceStructureModule.jsx | 문장의 짜임 |

### 학습 콘텐츠 유형 (learningCatalog.js 기준, 15종)

| ID | 카테고리 | 모듈 키 |
|----|---------|---------|
| vocab-basic-word | 어휘 학습 | worksheet_quiz |
| vocab-dictionary-fill | 어휘 학습 | worksheet_quiz |
| reading-intensive | 독해 연습 | reading_intensive |
| reading-recall | 독해 연습 | recall_cards |
| reading-confirm | 독해 연습 | confirm_click |
| content-pdf-quiz | 내용 숙지 학습 | worksheet_quiz |
| grammar-word-formation | 문법 연습 | word_formation |
| grammar-sentence-structure | 문법 연습 | sentence_structure |
| grammar-phoneme-change | 문법 연습 | phoneme_change |
| grammar-pos-quiz | 문법 연습 | worksheet_quiz |
| background-knowledge | 배경지식 퀴즈 | worksheet_quiz |
| language-concept | 국어 개념/이론 | worksheet_quiz |
| logic-reasoning | 논리사고력 | worksheet_quiz |
| descriptive-practice | 서술형 연습 | worksheet_quiz |
| choice-judgement | 선택지 판별 | choice_judgement |

---

## 6. 일일 퀴즈 시스템 상세

### 작동 방식
1. 사용자가 StartPage에서 "일일 퀴즈" 클릭 -> `/daily-quiz` 이동
2. DailyQuizPage가 `/v1/auth/me` 호출하여 사용자 levelId/gradeLabel 확인
3. 레벨에 맞는 폴더 + 오늘 날짜(day-of-year) 기반으로 JSON 파일 로드
4. EngineShell(moduleKey="worksheet_quiz")로 퀴즈 렌더링
5. 완료 후 결과를 localStorage에 저장

### 파일 구조
```
frontend/public/daily-quiz/{level}/{NNN}.json
```
- level: saussure1 ~ wittgenstein3 (12개 폴더)
- NNN: 001 ~ 365 (하루에 하나씩, 1년치)
- 현재 각 레벨에 001.json 샘플 1개씩만 있음

### JSON 형식 (EngineShell 호환)
```json
{
  "contentId": "dq-saussure1-001",
  "contentType": "DAILY_QUIZ",
  "targetLevel": "SAUSSURE_1",
  "schoolGradeRange": { "min": 1, "max": 1 },
  "timeLimitSec": 180,
  "seedReward": { "seedType": "WHEAT", "count": 3, "multiplier": 1 },
  "assets": { "sheetBackground": "/learning-paper.jpg" },
  "payload": {
    "pageStack": true,
    "layout": "EXAM_SHEET",
    "questions": [
      {
        "id": "dq-s1-001-1",
        "type": "MULTI_CHOICE",
        "questionKind": "WORD_TO_MEANING",
        "stem": "낱말: 엄마",
        "highlight": { "text": "엄마" },
        "prompt": "뜻을 고르세요.",
        "choices": [
          { "id": "A", "text": "..." },
          { "id": "B", "text": "..." },
          { "id": "C", "text": "..." },
          { "id": "D", "text": "..." }
        ],
        "answerId": "A",
        "scoring": { "correct": 20, "wrong": -20 }
      }
    ]
  }
}
```

### 씨앗 보상 정책 (SeedRewardPolicy.kt)
| 콘텐츠 난이도 - 사용자 레벨 | 보상 씨앗 |
|---------------------------|----------|
| +2 이상 (어려움) | 5개 |
| +1 | 4개 |
| 0 (동일) | 3개 |
| -1 | 2개 |
| -2 이하 (쉬움) | 1개 |

---

## 7. 백엔드 API 주요 엔드포인트

### 인증
- `POST /v1/auth/signup` - 회원가입
- `POST /v1/auth/login` - 로그인
- `POST /v1/auth/logout` - 로그아웃
- `GET /v1/auth/me` - 내 프로필 (levelId, gradeLabel 포함)
- `GET /v1/auth/orgs` - 기관 목록

### 무료 학습
- `GET /v1/learning/daily-quiz` - 일일 퀴즈 (feature flag: feature.free.daily_quiz)
- `POST /v1/learning/daily-quiz/submit` - 퀴즈 제출
- `GET /v1/learning/daily-reading` - 일일 독해
- `POST /v1/learning/daily-reading/submit` - 독해 제출

### 유료 학습
- `POST /v1/paid-learning/submit` - 유료 학습 제출

### 경제
- `GET /v1/economy/inventory` - 인벤토리 (씨앗/수확물)
- `POST /v1/economy/harvest/craft` - 수확물 교환

---

## 8. 프로젝트 설정 참고

### application.yml 현재 상태
- `jpa.hibernate.ddl-auto`: **update** (원래 validate, 테스트용으로 변경됨)
- `flyway.enabled`: **false** (원래 true, V0006 충돌로 비활성화)
- DB: localhost:3306/korfarm, root/korfarm

### Flyway 마이그레이션 이슈
- V0006이 2개 존재했음 (parent_student_links + alter_file_size)
- alter_file_size를 삭제하여 해결
- 현재 Flyway 비활성화 상태, ddl-auto=update로 테이블 자동 생성 중
- **프로덕션 배포 전 Flyway를 다시 활성화하고 정리 필요**

### MySQL 데이터 경로
```
C:\Users\RENEWCOM PC\mysql-data
```
MySQL 서비스 미등록 상태. 수동 실행 필요 (2절 참조).

---

## 9. 남은 작업

### 높은 우선순위

1. **일일 퀴즈 데이터 채우기**
   - 현재: 레벨당 1개 (001.json)
   - 목표: 레벨당 365개 (001.json ~ 365.json)
   - 총 12 x 365 = 4,380개 JSON 파일 필요
   - 형식은 기존 001.json과 동일

2. **일일 퀴즈 백엔드 제출 연동**
   - EngineShell 완료 시 `/v1/learning/daily-quiz/submit` API 호출 연결
   - 현재는 localStorage에만 저장됨
   - 씨앗 보상이 실제로 경제 시스템에 반영되도록

3. **일일 독해 시스템 구현**
   - 일일 퀴즈와 동일한 패턴으로 독해 콘텐츠 구성 필요
   - StartPage "일일 독해" 카드 클릭 핸들러 연결 필요

4. **StartPage 실제 데이터 연동**
   - 현재 하드코딩된 더미 데이터 (XP, 씨앗 수, 연속일, 랭킹 등)
   - `/v1/auth/me`, `/v1/economy/inventory`, 시즌 API와 연동 필요

5. **feature flag 등록**
   - `feature.free.daily_quiz`
   - `feature.free.daily_reading`
   - 관리자 페이지에서 등록하거나 DB에 직접 INSERT

### 중간 우선순위

6. **Flyway 마이그레이션 정리**
   - ddl-auto를 validate로 원복
   - Flyway enabled=true로 원복
   - V0006 ~ V0008 마이그레이션 파일 순서/충돌 정리

7. **대결(Duel) 시스템 프론트 연결**
   - 페이지는 존재 (DuelMainPage 등) 하지만 미커밋 상태
   - WebSocket 기반 실시간 대결 백엔드는 구현됨

8. **과제 시스템 프론트 연결**
   - AssignmentsPage.jsx 존재하지만 미커밋
   - StartPage "과제 바구니" 카드 클릭 핸들러 연결

9. **커뮤니티 페이지 개선**
   - 박스형 -> 게시판 형태로 전환 (이전에 작업했으나 되돌림)
   - 자료실 게시판: 관리자만 업로드 가능하도록 제한

10. **쇼핑몰/결제 실결제 연동**
    - 현재 결제 플로우는 모의(mock) 상태

### 낮은 우선순위

11. **GitHub Pages 배포 정리**
    - 이전에 배포함: https://amis99.github.io/korfarm-v2/
    - base path, 이미지 경로 이슈로 되돌림
    - 재배포 시 vite.config.js에 base 설정 + 이미지 경로 수정 필요

12. **프론트엔드 미커밋 파일들 정리 및 커밋**
    - components/, constants/, hooks/, utils/api.js
    - 대결/과제/농장모드/시험보관함 등 신규 페이지들
    - 스타일 파일들 (duel.css, assignments.css 등)

13. **모바일 반응형 개선**
    - 일부 페이지 모바일 레이아웃 미완

14. **프로덕션 배포 준비**
    - AWS 인프라 설정
    - 환경변수 분리 (JWT_SECRET, DB 접속 정보 등)
    - HTTPS/도메인 설정

---

## 10. 파일 구조 요약

```
국어농장v2홈페이지/
├── frontend/                    (React + Vite)
│   ├── public/
│   │   ├── daily-quiz/          (일일 퀴즈 JSON 12레벨)
│   │   ├── korfarm-logo.png
│   │   ├── learning-paper.jpg
│   │   └── 모달 이미지들 (질문 모달.png 등)
│   ├── src/
│   │   ├── App.jsx              (라우팅)
│   │   ├── pages/               (35개 페이지)
│   │   ├── engine/              (학습 엔진 16개 파일)
│   │   ├── styles/              (12개 CSS)
│   │   ├── data/learning/       (학습 카탈로그 + 샘플 JSON)
│   │   ├── components/          (공통 컴포넌트)
│   │   ├── hooks/               (커스텀 훅)
│   │   └── utils/               (유틸리티)
│   ├── package.json
│   └── vite.config.js
│
├── backend/                     (Spring Boot + Kotlin)
│   ├── src/main/kotlin/com/korfarm/api/
│   │   ├── auth/                (인증)
│   │   ├── user/                (사용자)
│   │   ├── security/            (JWT 보안)
│   │   ├── learning/            (무료 학습)
│   │   ├── paid/                (유료 학습)
│   │   ├── economy/             (씨앗 경제)
│   │   ├── season/              (시즌/랭킹)
│   │   ├── duel/                (대결)
│   │   ├── assignments/         (과제)
│   │   ├── board/               (게시판)
│   │   ├── shop/                (쇼핑몰)
│   │   ├── payment/             (결제)
│   │   ├── files/               (파일 업로드)
│   │   ├── org/                 (기관)
│   │   ├── print/               (인쇄)
│   │   ├── system/              (기능 플래그)
│   │   ├── common/              (공통)
│   │   └── contracts/           (API DTO)
│   ├── src/main/resources/
│   │   ├── application.yml
│   │   └── db/migration/        (Flyway, 현재 비활성화)
│   └── build.gradle.kts
│
└── docs/                        (문서)
    ├── 프로젝트_현황_명세서.md    (이 문서)
    └── learning/                (학습 관련 문서)
```
